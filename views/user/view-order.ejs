<%- include('./layouts/profile-header.ejs') %>
  <% allOrders.forEach((orders)=>{ %>
    <div class="p-3 user-info col border rounded">
      <div class="row">
        <div class="p-3 d-flex justify-content-between">
          <p class="" type="button" data-toggle="collapse" aria-expanded="false"
            aria-controls="multiCollapseExample1 multiCollapseExample2">
            Order ID: <%=orders._id %>
          </p>
          <h6>
            <%=orders.status %>
          </h6>
          <div>
            <h6>Expected Date</h6>
            <!-- <p><%=orders.date  %> </p> -->
          </div>

          <a class="" data-toggle="collapse" data-target=".multi-collapse" href="#" role="button" aria-expanded="false"
            aria-controls="multiCollapseExample">View Order Details</a>

          <div class="text-end me-3">
            <a href="/admin/invoice/<%=orders._id %> ">Download Invoic</a>
          </div>
        </div>
        <div class="">
          <div class="">
            <% orders.products.forEach((product)=>{ %>
              <div class="row d-flex border justify-content-center align-items-center p-2 my-2">
                <div class="col-2">
                  <img style="width: 60px" src="/images/<%=product.product.image %> " alt="" />
                </div>
                <div class="col-3">
                  <p>
                    <%=product.product.name %>
                  </p>
                </div>
                <div class="col-2">
                  <p>
                    <%= product.quantity %>
                  </p>
                </div>
                <div class="col-2">
                  <p>
                    <%= product.totalPrice %>
                  </p>
                </div>
                <div class="col-3">
                  <p>
                    <% if (product.status=='Order Confirmed' ){ %>
                      <button type="button" class="btn btn-inverse-secondary btn-fw">
                        Order Confirm
                      </button>
                      <% }else if(product.status=='Packed' ){ %>
                        <button type="button" class="btn btn-inverse-primary btn-fw">
                          Packed
                        </button>
                        <% }else if(product.status=='Shipping' ){ %>
                          <button type="button" class="btn btn-inverse-info btn-fw">
                            Shippping
                          </button>
                          <% }else if(product.status=='Delivered' ){ %>
                            <button type="button" class="btn btn-inverse-success btn-fw">
                              Delivered
                            </button>
                            <% }else{ %>
                              <button type="button" class="btn btn-inverse-danger btn-fw">
                                Canceled
                              </button>
                              <% } %>
                  </p>
                </div>
              </div>
              <% }) %>
                <div class="container card my-3 px-5 py-5 border">
                  <div class="row">
                    <div class="col">Subtotal</div>
                    <div class="col text-end">
                      <%=orders.grandTotal %>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">Delivery Charge</div>
                    <div class="col font-italic text-success text-end">
                      FREE
                    </div>
                    <hr class="mt-3" style="border-top: 1px dashed black" />
                  </div>
                  <div class="row">
                    <div class="col">Total</div>
                    <div class="col font-weight-bold text-end">
                      <%=orders.grandTotal %>
                    </div>
                  </div>
                </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="collapse multi-collapse" id="multiCollapseExample1">
              <div class="card card-body">
                <h5>Payment Method</h5>
                <p>
                  <%= orders.paymentMethod %>
                </p>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="collapse multi-collapse" id="multiCollapseExample2">
              <div class="card card-body">
                <h5>Billing Address</h5>
                <p>
                  <%= orders.address.fullName %>, <%= orders.address.phone %> <br />
                      <%= orders.address.addrssLine %>
                        <%= orders.address.city %>
                          <%= orders.address.state %>- <%= orders.address.pincode %>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <% }) %>
      </div>
      </div>
      <!-- main-panel ends -->
      </div>
      >
      <script>
        function changeStatus(status, orderId, proId) {
          axios
            .post("/admin/order-manage", { status, orderId, proId })
            .then(() => {
              window.location.reload();
            });
        }
      </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
      <script src="/admin/common js/sweatAlert.js"></script>
      <script src="/admin/common js/dom.js"></script>
      <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
      <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script src="/admin/vendors/js/vendor.bundle.base.js"></script>
      <script src="/admin/vendors/chart.js/Chart.min.js"></script>
      <script src="/admin/vendors/datatables.net/jquery.dataTables.js"></script>
      <script src="/admin/vendors/datatables.net-bs4/dataTables.bootstrap4.js"></script>
      <script src="/admin/js/dataTables.select.min.js"></script>
      <script src="https://kit.fontawesome.com/23385eff2a.js" crossorigin="anonymous"></script>
      <script src="/admin/js/off-canvas.js"></script>
      <script src="/admin/js/hoverable-collapse.js"></script>
      <script src="/admin/js/template.js"></script>
      <script src="/admin/js/settings.js"></script>
      <script src="/admin/js/todolist.js"></script>
      <script src="/admin/js/dashboard.js"></script>
      <script src="/admin/js/Chart.roundedBarCharts.js"></script>
      </body>

      </html>